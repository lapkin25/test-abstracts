
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Аппроксимация. Метод наименьших квадратов &#8212; Элементы математики</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="_static/../styles/editor_styles.css?v=14e1f340" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ls';</script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <script src="_static/../js/pyodide_api.js?v=56641602"></script>
    <script src="_static/../js/editor_api.js?v=f0b4a606"></script>
    <script src="_static/../js/editor.bundle.js?v=1047e269"></script>
    <script src="_static/tests/ls_task1.js?v=115f8710"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Статистика" href="statistics.html" />
    <link rel="prev" title="Умножение матриц" href="matrix-mult.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Элементы математики - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Элементы математики - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Элементы математики
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="linalg.html">Линейная алгебра</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="linear-spaces.html">Линейные пространства и линейные отображения</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear-mappings.html">Линейные отображения</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix-mult.html">Умножение матриц</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Аппроксимация. Метод наименьших квадратов</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="statistics.html">Статистика</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="linear-regression.html">Линейная регрессия</a></li>
<li class="toctree-l2"><a class="reference internal" href="regression_use.html">Использование линейной регрессии</a></li>
<li class="toctree-l2"><a class="reference internal" href="naive-Bayes.html">Наивный байесовский классификатор</a></li>
<li class="toctree-l2"><a class="reference internal" href="monte_carlo.html">Метод Монте-Карло</a></li>
<li class="toctree-l2"><a class="reference internal" href="confusion.html">Матрица неточности</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="algorithms.html">Алгоритмы</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="algo-intro1.html">Начало тренировок</a></li>
<li class="toctree-l2"><a class="reference internal" href="algo-seq-sets.html">Последовательности и множества</a></li>
<li class="toctree-l2"><a class="reference internal" href="algo-trees-graphs.html">Деревья и графы</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="entertainment.html">Развлечения</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="math_cards.html">Математические открытки</a></li>
<li class="toctree-l2"><a class="reference internal" href="math_songs.html">Математические песни</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lapkin25/test-abstracts" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lapkin25/test-abstracts/issues/new?title=Issue%20on%20page%20%2Fls.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ls.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Аппроксимация. Метод наименьших квадратов</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Введение</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Теория</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approx-steps">Этапы аппроксимации</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Метод наименьших квадратов</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>Аппроксимация. Метод наименьших квадратов<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<section id="id2">
<h2>Введение<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
</section>
<section id="id3">
<h2>Теория<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>Аппроксимация – это замена одной функции <span class="math notranslate nohighlight">\(f(x)\)</span> другой, похожей функцией <span class="math notranslate nohighlight">\(Y(x)\)</span>. Методы аппроксимации применяют как в случае, когда функция <span class="math notranslate nohighlight">\(f(x)\)</span> задана в табличном виде, так и тогда, когда функция <span class="math notranslate nohighlight">\(f(x)\)</span> является непрерывной и есть необходимость получить упрощенное математическое описание имеющейся сложной зависимости. На практике задача аппроксимации часто возникает тогда, когда по экспериментальным данным требуется подобрать такую аналитическую функцию, которая проходила бы как можно ближе к экспериментальным точкам. Построенная в результате решения задачи аппроксимации кривая сглаживает обрабатываемые экспериментальные данные и показывает общую тенденцию зависимости одного параметра от другого.<br />
Пусть в результате эксперимента получены данные, представленные в следующей таблице:</p>
<style>
  .custom-bg-table {
    border: 1px solid grey;
    width: 250px;
    margin: 0 auto;
  }
</style>
<div class="custom-bg-table docutils">
<table class="table table-center">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{x_i}\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(x_0\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></th>
<th class="head text-center"><p>…</p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(x_m\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{y_i}\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_0\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_1\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_2\)</span></p></td>
<td class="text-center"><p>…</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y_m\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Необходимо заменить таблично заданную функцию аналитической функцией <span class="math notranslate nohighlight">\(Y=f(x,c_0,c_1,...,c_k)\)</span>. При этом искомая функция <span class="math notranslate nohighlight">\(f(x,c_0,c_1,...,c_k)\)</span> может зависеть от параметров как линейно, и тогда говорят о линейной аппроксимации, так и нелинейно. При решении задачи надо таким образом подобрать коэффициенты <span class="math notranslate nohighlight">\(c_0,c_1,...,c_k\)</span> функции <span class="math notranslate nohighlight">\(Y\)</span>, чтобы отклонения экспериментальных значений <span class="math notranslate nohighlight">\(y_i\)</span> от модельных <span class="math notranslate nohighlight">\(Y_i=f(x_i,c_0,c_1,...,c_k)\)</span> были минимальными.</p>
<section id="approx-steps">
<span id="id4"></span><h3>Этапы аппроксимации<a class="headerlink" href="#approx-steps" title="Link to this heading">#</a></h3>
<p>Решение задачи аппроксимации состоит из нескольких этапов. На первом этапе надо
определить вид зависимости, т. е. выбрать такую кривую, которая лучше всего подходит для описания экспериментальных данных. Определить вид кривой можно визуально, представив данные графически, например:</p>
<img alt="linear_depend_sample" class="bg-primary align-center" id="fig-1" src="_images/Figure_1.jpg" />
<p>Очевидно, что в общем случае Y зависит от X линейно, поэтому аппроксимацию можно осуществить прямой, заданной функцией <span class="math notranslate nohighlight">\(Y=c_0+c_1x\)</span>.</p>
<p>Вторым этапом является вычисление коэффициентов <span class="math notranslate nohighlight">\(c_i\)</span>. Всего существует три основных подхода к решению задани аппроксимации (поиску коэффициентов <span class="math notranslate nohighlight">\(c_i\)</span>) а именно: метод наименьших модулей, минимаксный подход и метод наименьших квадратов.</p>
</section>
</section>
<section id="id5">
<h2>Метод наименьших квадратов<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>Этот метод аппроксимации применяется во многих областях науки науки (в математической статистике, физике, биологии и т.д) а так же в обработке изображений.
Метод заключается в отыскании такой аппроксимирующей функции, сумма квадратов отклонений <span class="math notranslate nohighlight">\(F\)</span> от которой до экспериментальных (табличных) значений будет наименьшей (<span class="math notranslate nohighlight">\(F \to min\)</span>). Эта функция выглядит следующим образом:</p>
<div class="math notranslate nohighlight">
\[
F=\sum_{i=1}^{n}{(y_i-f(x_i))^2}
\]</div>
<p>Разберем простой пример: пусть необходимо построить аппроксимирующую прямую для табличной функции:</p>
<table class="table table-center" style="width: 220px">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span></p></th>
<th class="head text-center"><p>0</p></th>
<th class="head text-center"><p>1</p></th>
<th class="head text-center"><p>2</p></th>
<th class="head text-center"><p>3</p></th>
<th class="head text-center"><p>4</p></th>
<th class="head text-center"><p>5</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span></p></td>
<td class="text-center"><p>2.1</p></td>
<td class="text-center"><p>3.2</p></td>
<td class="text-center"><p>3.5</p></td>
<td class="text-center"><p>4.7</p></td>
<td class="text-center"><p>5.4</p></td>
<td class="text-center"><p>5.8</p></td>
</tr>
</tbody>
</table>
<p>Точечный график этой функции выглядит так:</p>
<img alt="ls_task_1" class="bg-primary align-center" id="fig-2" src="_images/Figure_2.jpg" />
</br>
<p><a class="reference internal" href="#approx-steps">В соответствии с этапами</a> необходимо выбрать наиболее подходящую функцию (по условию задачи функция линейная: <span class="math notranslate nohighlight">\(Y=c_0+c_1x\)</span>) и найти коэффициенты <span class="math notranslate nohighlight">\(c_i\)</span>. Подставим <span class="math notranslate nohighlight">\(Y\)</span> вместо <span class="math notranslate nohighlight">\(f(x)\)</span> в функции <span class="math notranslate nohighlight">\(F\)</span>:</p>
<div class="math notranslate nohighlight">
\[
F=\sum_{i=1}^{n}{(y_i-(c_0+c_1x_i))^2}
\]</div>
<p>Задача сводится к поиску таких коэффициентов <span class="math notranslate nohighlight">\(c_0\)</span> и <span class="math notranslate nohighlight">\(c_1\)</span> при которых <span class="math notranslate nohighlight">\(F \to min\)</span>. Для этого продифференцируем <span class="math notranslate nohighlight">\(F\)</span> по <span class="math notranslate nohighlight">\(c_0\)</span> и <span class="math notranslate nohighlight">\(c_1\)</span> и составим систему уравнений:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\frac{\partial F}{\partial c_0}=0 \\
\frac{\partial F}{\partial c_1}=0
\end{cases}
\implies
\begin{cases}
c_1\sum\limits_{i=1}^{n}{x_i^2} &amp;+ &amp;c_0\sum\limits_{i=1}^{n}{x_i} &amp;- &amp;\sum\limits_{i=1}^{n}{x_iy_i}&amp;= 0 \\
c_1\sum\limits_{i=1}^{n}{x_i} &amp;+ &amp;c_0n &amp;- &amp;\sum\limits_{i=1}^{n}{y_i}&amp;= 0
\end{cases}
\end{split}\]</div>
<p>Свободные члены перенесем в правую часть:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
c_1\sum\limits_{i=1}^{n}{x_i^2} &amp;+ &amp;c_0\sum\limits_{i=1}^{n}{x_i} &amp;= \sum\limits_{i=1}^{n}{x_iy_i} \\
c_1\sum\limits_{i=1}^{n}{x_i} &amp;+ &amp;c_0n &amp;= \sum\limits_{i=1}^{n}{y_i}
\end{cases}
\end{split}\]</div>
<p>Вычислим <span class="math notranslate nohighlight">\(x_i^2\)</span>, <span class="math notranslate nohighlight">\(x_iy_i\)</span> и дополним ими исходную таблицу:</p>
<table class="table table-center" style="width: 220px">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span></p></th>
<th class="head text-center"><p>0</p></th>
<th class="head text-center"><p>1</p></th>
<th class="head text-center"><p>2</p></th>
<th class="head text-center"><p>3</p></th>
<th class="head text-center"><p>4</p></th>
<th class="head text-center"><p>5</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span></p></td>
<td class="text-center"><p>2.1</p></td>
<td class="text-center"><p>3.2</p></td>
<td class="text-center"><p>3.5</p></td>
<td class="text-center"><p>4.7</p></td>
<td class="text-center"><p>5.4</p></td>
<td class="text-center"><p>5.8</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{x^2}\)</span></p></td>
<td class="text-center"><p>0</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p>4</p></td>
<td class="text-center"><p>9</p></td>
<td class="text-center"><p>16</p></td>
<td class="text-center"><p>25</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\boldsymbol{xy}\)</span></p></td>
<td class="text-center"><p>0.0</p></td>
<td class="text-center"><p>3.2</p></td>
<td class="text-center"><p>7.0</p></td>
<td class="text-center"><p>14.1</p></td>
<td class="text-center"><p>21.6</p></td>
<td class="text-center"><p>29.0</p></td>
</tr>
</tbody>
</table>
<p>Теперь вычислим все суммы и подсавим их в систему:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
55c_1 &amp;+ &amp;15c_0 &amp;= 74,9 \\
15c_1 &amp;+ &amp;6c_0 &amp;= 24,7
\end{cases}
\end{split}\]</div>
<p>Решив систему получим коэффициенты аппроксимирующей прямой <span class="math notranslate nohighlight">\(Y\)</span>. Решать систему будем на языке <code class="docutils literal notranslate"><span class="pre">Python</span></code> при помощи модулей <code class="docutils literal notranslate"><span class="pre">numpy</span></code> и <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># Исходные данные</span>
<span class="linenos"> 6</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="linenos"> 7</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">,</span> <span class="mf">5.8</span><span class="p">])</span>
<span class="linenos"> 8</span><span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Формируем список из x^2</span>
<span class="linenos">11</span><span class="n">X2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="p">]</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="c1"># Формируем список из xy</span>
<span class="linenos">14</span><span class="n">XY</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)]</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1"># Создаем систему из коэффициентов при неизвестных (в том же порядке что и системе уравнений)</span>
<span class="linenos">17</span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="linenos">18</span>    <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">X2</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
<span class="linenos">19</span>    <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">n</span><span class="p">]</span>
<span class="linenos">20</span><span class="p">])</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="c1"># Создаем вектор-строку из свободных членов и превращаем его в вектор-столбец функцией reshape</span>
<span class="linenos">23</span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="linenos">24</span>              <span class="nb">sum</span><span class="p">(</span><span class="n">XY</span><span class="p">),</span> 
<span class="linenos">25</span>              <span class="nb">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="linenos">26</span>              <span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="c1"># 2 - кол-во столбцов исходного вектора, 1 - кол-во строк исходного вектора</span>
<span class="linenos">27</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="c1"># функция solve найдет неизвестные</span>
<span class="linenos">30</span><span class="n">result</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="linenos">31</span><span class="n">c0</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">32</span><span class="n">c1</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">33</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;c0 = </span><span class="si">{</span><span class="n">c0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">34</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;c1 = </span><span class="si">{</span><span class="n">c1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c0 = 2.238095238095238
c1 = 0.7514285714285716
</pre></div>
</div>
</div>
</div>
<p>Получили коэффициенты <span class="math notranslate nohighlight">\(c_1\)</span> и <span class="math notranslate nohighlight">\(c_0\)</span> соответственно. Подставим их в уравнение прямой <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
Y = 2,24 + 0,75x
\end{aligned}
\]</div>
<p>Задача решена. Изобразим решение графически:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="c1"># Определяем график Y от X</span>
<span class="linenos"> 4</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Исходные данные&quot;</span><span class="p">)</span><span class="c1"># параметр &#39;o&#39; задает точечный график</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="c1"># Зададим названия осей</span>
<span class="linenos"> 7</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Определяем аппроксимирующую прямую</span>
<span class="linenos">11</span><span class="n">Y_approx</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">X</span> <span class="c1"># (см. заметку)</span>
<span class="linenos">12</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_approx</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Аппроксимирующая прямая&quot;</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="linenos">15</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a8537ef8fe82bb0d2fcf71f22b14e2ad2abbcb54a236d43cfbfc4babf256b2f1.png" src="_images/a8537ef8fe82bb0d2fcf71f22b14e2ad2abbcb54a236d43cfbfc4babf256b2f1.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Следует объяснить выражение <code class="docutils literal notranslate"><span class="pre">Y_approx</span> <span class="pre">=</span> <span class="pre">c0</span> <span class="pre">+</span> <span class="pre">c1</span> <span class="pre">*</span> <span class="pre">X</span></code> в девятой строке кода.
Тип объекта <code class="docutils literal notranslate"><span class="pre">X</span></code> - <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> массив (похожий на тип списка <code class="docutils literal notranslate"><span class="pre">List</span></code>) определенный в модуле <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. На этот массив можно умножать число и прибавлять к нему число. При умножении на число - каждый элемент массива умножается на это число, аналогично и при сложении: каждый элемент массива складывается в числом, например:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lst</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lst</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">8</span><span class="p">]</span>   
<span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<p>При умножении списка <code class="docutils literal notranslate"><span class="pre">List</span></code> на число происходит его копирование <code class="docutils literal notranslate"><span class="pre">n</span></code> раз самого в себя, например:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lst</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>Будьте внимательны с типами имеющими схожее назначение.</p>
</div>
<p><em>Задание.</em> Перед вами результаты наблюдений длительности нахождения
человека в очереди в зависимости от количества людей в этой очереди.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Номер наблюдения</p></th>
<th class="head"><p>Количество человек в очереди, <span class="math notranslate nohighlight">\(X\)</span></p></th>
<th class="head"><p>Время, проведенное в очереди (мин), <span class="math notranslate nohighlight">\(Y\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>22</p></td>
<td><p>45</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>19</p></td>
<td><p>42</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>11</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>7</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>13</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>20</p></td>
<td><p>39</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>8</p></td>
<td><p>19</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>12</p></td>
<td><p>21</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>15</p></td>
<td><p>28</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>23</p></td>
<td><p>65</p></td>
</tr>
</tbody>
</table>
<p>Используйте модель линейной регрессии для прогнозирования и вычислите
коэффициенты регрессии <span class="math notranslate nohighlight">\(c_1, c_0\)</span>.</p>
<p><python-editor module-name="ls_task1"></python-editor></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="matrix-mult.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Умножение матриц</p>
      </div>
    </a>
    <a class="right-next"
       href="statistics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Статистика</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Введение</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Теория</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#approx-steps">Этапы аппроксимации</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Метод наименьших квадратов</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Кафедра математики и моделирования
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>